#include <vector>
#include <cmath>

namespace data {
std::vector<double> dts = {0, 0.2, 0.4, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100};
std::vector<double> noise = {0.0, 1.1745732788175703e-05, 4.700859296860148e-05, 9.057781256684314e-05, 0.00012218915659967358, 0.00016122558070857167, 0.0003675026690348994, 0.0005857965865018581, 0.0008128145204112871, 0.0010463444505194204, 0.0012846385897885106, 0.001529333921256465, 0.0017755433774743845, 0.0020253154604899146, 0.0022771430323747276, 0.0025349372265926987, 0.002791162270142261, 0.0030555111504404907, 0.003317613512318362, 0.0035786985196127868, 0.003844774337308447, 0.004110552250808285, 0.0043802507741415855, 0.00464828273428255, 0.004918709715894502, 0.00519281019363936, 0.0054715600533020185, 0.005742974702249377, 0.006016950770172551, 0.006292509312612993, 0.006580523368450268, 0.006851301369568136, 0.00713334497587454, 0.0074111314606292, 0.007693152523817793, 0.007975220531422666, 0.0082584252208109, 0.008539745487036739, 0.008829368217400612, 0.009111944570496975, 0.009397156139736275, 0.009685821890341706, 0.009968827829356904, 0.010258585586723221, 0.010554015182070995, 0.010835360950118353, 0.011127106030298754, 0.011420999919851696, 0.01171508990909071, 0.01200233726169671, 0.012307038228610652, 0.012594035727209353, 0.012881782037253556, 0.013191341241586002, 0.013463327671215879, 0.013755765527363685, 0.014059596693463627, 0.014359520380572277, 0.014652721383992774, 0.01496441887852464, 0.015253769796967229, 0.015545524786136357, 0.015835498245851287, 0.016129665252564006, 0.01644150716501775, 0.01675545465155513, 0.017041864682937675, 0.017344267113507967, 0.017650517059053066, 0.017944814382229356, 0.018270133767809633, 0.018547342817042, 0.01886361386877528, 0.01914038186802777, 0.019459900320004535, 0.01977956930863128, 0.020069801305426117, 0.020373679297122416, 0.020684084998643246, 0.020983983639019436, 0.02130504918647885, 0.021626033717988453, 0.021916442135198954, 0.022190982335276152, 0.02254426777388795, 0.022827679232892764, 0.023143181691274998, 0.02346256502232484, 0.023761328122862052, 0.02403143576983206, 0.02440805376080642, 0.024717776847301365, 0.02501462756749133, 0.025306868379887965, 0.025614000984412456, 0.02595472154721307, 0.026269815135330995, 0.026563683440431907, 0.026888467892336704, 0.027171410070509296, 0.027537359472476, 0.027862208233616334, 0.028148421712378847, 0.028465791531123514, 0.028755045515904937};

std::vector<std::vector <double>> Coeffs = {{-8.223265747111402e-06, 0.00013860277222820327, 3.5926223008325105e-05, -7.366147050056248e-06, 7.652052581335645e-07, -3.006187116588315e-08}, {-8.223265747111402e-06, 0.00013860277222820327, 3.5926223008325105e-05, -7.366147050056248e-06, 7.652052581335645e-07, -3.006187116588315e-08}, {-8.223265747111402e-06, 0.00013860277222820327, 3.5926223008325105e-05, -7.366147050056248e-06, 7.652052581335645e-07, -3.006187116588315e-08}, {-1.0471144163652765e-05, 0.00015059881108641214, 2.3656092399739425e-05, -3.0531516375918347e-06, 1.5425222961721658e-07}, {-1.0471144163652765e-05, 0.00015059881108641214, 2.3656092399739425e-05, -3.0531516375918347e-06, 1.5425222961721658e-07}, {-1.5637792999165126e-05, 0.00016951391087638795, 1.1633402313111297e-05, -6.097242969967167e-07}, {-2.2501602386837643e-05, 0.00018714408896036854, 5.0628482505332965e-06}, {-2.641995275353586e-05, 0.00019392022643490272, 3.898201073437038e-06}, {-3.1810665150773824e-05, 0.00020120592610693838, 2.9293399865269918e-06}, {-3.499773434882279e-05, 0.00020464216810906776, 2.5631259672648362e-06}, {-3.8844344064493594e-05, 0.00020819648784320822, 2.233831420578423e-06}, {-1.4187354773287602e-05, 0.00016510775032370004, 1.35920333171639e-05, -8.193192452481978e-07}, {-1.4187354773287602e-05, 0.00016510775032370004, 1.35920333171639e-05, -8.193192452481978e-07}, {-8.223265747111402e-06, 0.00013860277222820327, 3.5926223008325105e-05, -7.366147050056248e-06, 7.652052581335645e-07, -3.006187116588315e-08}, {-8.223265747111402e-06, 0.00013860277222820327, 3.5926223008325105e-05, -7.366147050056248e-06, 7.652052581335645e-07, -3.006187116588315e-08}, {-9.059330472493401e-06, 0.00014331908385036932, 3.093932354318395e-05, -5.604030156182705e-06, 5.188838309045734e-07, -1.8265056178169757e-08}, {-1.00395758025159e-05, 0.00014822942534663874, 2.635312022436246e-05, -4.155852949560846e-06, 3.3706013733821205e-07, -1.0424226587023836e-08}, {-1.0578214738621436e-05, 0.00015067617530888748, 2.4307699123450104e-05, -3.57247783784994e-06, 2.7061420529970966e-07, -7.8189658959756e-09}, {-1.1534987200805804e-05, 0.00015467857873373536, 2.1277860046479848e-05, -2.784639262139474e-06, 1.8850977845421578e-07, -4.867784034374051e-09}, {-1.2013951952411818e-05, 0.0001565449606290768, 1.998566556652455e-05, -2.4758130527217153e-06, 1.5884410433961275e-07, -3.883344765725209e-09}, {0.00018064840962460013, 5.247651824833128e-05, 4.0518229466220616e-05, -4.32232541990467e-06, 2.3360699790990783e-07, -4.93273818434625e-09}, {-1.3351608655513564e-05, 0.00016126211111849487, 1.7115785942382256e-05, -1.869304805423725e-06, 1.0709316633334027e-07, -2.353210831115149e-09}, {-2.314671012619454e-05, 0.00017481813736197982, 1.2365161206080973e-05, -1.2014852462044326e-06, 6.576454100650128e-08, -1.3974352085570997e-09}, {-2.314671012619454e-05, 0.00017481813736197982, 1.2365161206080973e-05, -1.2014852462044326e-06, 6.576454100650128e-08, -1.3974352085570997e-09}, {-2.3867548981086617e-05, 0.0001763128972233175, 1.1584115700306362e-05, -1.0463296232859651e-06, 5.311140197323697e-08, -1.0476013634134036e-09}, {-2.362607087611499e-05, 0.00017566814269412144, 1.1942336599351095e-05, -1.1149682799802792e-06, 5.7981702334867514e-08, -1.1421984774401278e-09}, {-2.362607087611499e-05, 0.00017566814269412144, 1.1942336599351095e-05, -1.1149682799802792e-06, 5.7981702334867514e-08, -1.1421984774401278e-09}, {0.025282101671552905, -0.006898992540423299, 0.0007948915174126705, -4.383845989731387e-05, 1.2011695275778117e-06, -1.306853832539357e-08}, {0.025282101671552905, -0.006898992540423299, 0.0007948915174126705, -4.383845989731387e-05, 1.2011695275778117e-06, -1.306853832539357e-08}, {0.010150148742718402, -0.0026310150411755213, 0.00031704523983242953, -1.7291646756167923e-05, 4.6932074943828924e-07, -5.058253191466116e-09}, {0.0007588979468184558, -8.39592417626524e-05, 4.328251591246852e-05, -2.712900798544031e-06, 8.457223952842679e-08, -1.0315214965560867e-09}, {0.11163413762407098, -0.025062248219477477, 0.002278675239594536, -0.00010200965573051242, 2.2727717383394877e-06, -2.0157881220565083e-08}, {0.11163413762407098, -0.025062248219477477, 0.002278675239594536, -0.00010200965573051242, 2.2727717383394877e-06, -2.0157881220565083e-08}, {0.0711441200653872, -0.015339173700852521, 0.001354252466396025, -5.8481176233473904e-05, 1.2570413414051307e-06, -1.0756188090817881e-08}, {0.025852175233529326, -0.005426748525915963, 0.0004905121917416424, -2.1023503225198557e-05, 4.485796357680092e-07, -3.8084703078916995e-09}, {0.00014708173417229877, 0.0001264397511144719, 1.4973540138522832e-05, -8.501616896201208e-07, 2.4616028938759372e-08, -2.7597455330575084e-10}, {-2.9441012527136722e-05, 0.00018642722751184898, 7.418570496167808e-06, -4.0393567467787076e-07, 1.2127938670401142e-08, -1.4215577300558498e-10}, {0.1926907582162539, -0.03494701562646479, 0.002557974580610445, -9.254876109803247e-05, 1.6682428792990007e-06, -1.1984574759243277e-08}, {0.13806956724531816, -0.024797458554493328, 0.0018061209188330114, -6.479456990950475e-05, 1.157696686923188e-06, -8.240467350801792e-09}, {0.061861035021854645, -0.01104063658813406, 0.0008165014807064219, -2.9330529577668707e-05, 5.245474873449633e-07, -3.734968653150775e-09}, {0.00016150219171015383, 0.00012694049600694336, 1.4245994085786708e-05, -7.629228786149123e-07, 2.064257459035192e-08, -2.1211649940038133e-10}, {0.00016150219171015383, 0.00012694049600694336, 1.4245994085786708e-05, -7.629228786149123e-07, 2.064257459035192e-08, -2.1211649940038133e-10}, {0.036347304760496094, -0.00616109599773327, 0.00044579863539423936, -1.5344539619419845e-05, 2.6245789933924123e-07, -1.7830762173839595e-09}, {0.026359588392686224, -0.004396741475974948, 0.0003217015843777601, -1.1000107537024387e-05, 1.8675095799158286e-07, -1.2576652680439462e-09}, {-2.102423070160335e-05, 0.00018744249901025888, 6.661693156385189e-06, -3.134858616763457e-07, 8.067133977302771e-09, -7.969113860204147e-11}, {-2.102423070160335e-05, 0.00018744249901025888, 6.661693156385189e-06, -3.134858616763457e-07, 8.067133977302771e-09, -7.969113860204147e-11}, {0.5417379837589815, -0.07612000940870729, 0.004293834871491076, -0.00012037490761291813, 1.6833170675841739e-06, -9.392769864842443e-09}, {0.19082912056687276, -0.02624757212619101, 0.0014661817862174616, -4.04273281571664e-05, 5.56108985711846e-07, -3.0523223250138176e-09}, {0.0360937917592778, -0.00606533496623402, 0.0004336265597296581, -1.4651770742163496e-05, 2.441852308259521e-07, -1.6007231017035536e-09}, {0.0360937917592778, -0.00606533496623402, 0.0004336265597296581, -1.4651770742163496e-05, 2.441852308259521e-07, -1.6007231017035536e-09}, {1.1306222336608722, -0.14106091662090328, 0.007052835998501927, -0.00017571043434859738, 2.1856144357706075e-06, -1.0858199052561635e-08}, {-4.5463308643526896e-05, 0.00019619756941274808, 5.4795044925611276e-06, -2.3754213658447946e-07, 5.727679342062116e-09, -5.186831616150984e-11}, {-4.5463308643526896e-05, 0.00019619756941274808, 5.4795044925611276e-06, -2.3754213658447946e-07, 5.727679342062116e-09, -5.186831616150984e-11}, {-4.810943893689091e-05, 0.00019796667868921536, 5.115749345889039e-06, -2.072784413985608e-07, 4.686696267402428e-09, -4.025674786605664e-11}, {4.133695928496212, -0.45978069374753155, 0.020454126235608477, -0.00045418344429836447, 5.037057175477134e-06, -2.232060425724769e-08}, {-0.32982361718165076, 0.029274879588889604, -0.0009573403977796922, 1.4038633134229398e-05, -7.710925513512365e-08}, {0.6637044050630594, -0.07252819545569812, 0.0031894618250974793, -6.983259486230302e-05, 7.643650183828104e-07, -3.346195369402505e-09}, {-0.00852079648728328, 0.0010603453597266852, -2.918499028758162e-05, 4.821289902167238e-07, -2.9317267919526195e-09}, {4.909623383397798, -0.5034724728548082, 0.020638869960342258, -0.00042211566550245, 4.309854147315135e-06, -1.7573880919941054e-08}, {-3.612736768778815e-05, 0.00019127718002949154, 6.308015038994453e-06, -2.9502618762563193e-07, 7.344012568780037e-09, -6.475822215436505e-11}, {4.973984913862517, -0.49427474400978827, 0.01964201281998516, -0.0003895648930957875, 3.858236703526601e-06, -1.526456804706866e-08}, {3.9579344065198656, -0.3928232523001019, 0.015594054437093397, -0.00030888648114795435, 3.055040098018239e-06, -1.2069210851214929e-08}, {2.5714773437139784, -0.26025771871388714, 0.010529907613588019, -0.00021225512372387127, 2.1338382982252714e-06, -8.558372692826777e-09}, {0.8422681514411599, -0.0855175446344915, 0.0034809003753968697, -7.036759427529817e-05, 7.088164646187333e-07, -2.8458439298682803e-09}, {0.31789418901564337, -0.03273128638562609, 0.001361291463210434, -2.7931173316634157e-05, 2.8522016029901333e-07, -1.1594187652053806e-09}, {0.005853271065832905, -0.0005640408681306518, 4.302782373312602e-05, -1.0897578020430553e-06, 1.3715728774103048e-08, -6.792633326608644e-11}, {38.314990836156454, -3.360941922414104, 0.11783928655287508, -0.0020637824767853682, 1.8055873666150603e-05, -6.313088145304402e-08}, {8.278916821833938, -0.7303265846010901, 0.025751258990379465, -0.000453173804498722, 3.981875308105309e-06, -1.397502302769027e-08}, {12.681402383265143, -1.113975424916186, 0.03910268810354124, -0.0006851118857345707, 5.99304314048471e-06, -2.0938511494095202e-08}, {0.3267205488069757, -0.032925443217653144, 0.0013387492017473055, -2.6819054316948995e-05, 2.669430233723462e-07, -1.05556479377579e-09}, {0.05808392300118876, -0.005845727831796591, 0.00025267807928751335, -5.160616695670292e-06, 5.223476610909299e-08, -2.0931984054048391e-10}, {63.954975033831495, -5.140539813979702, 0.16517833853423403, -0.0026518721830850237, 2.1273214641389336e-05, -6.821583378724405e-08}, {0.005414114588330762, -0.0005051598142953456, 3.97208397199976e-05, -9.925809294420877e-07, 1.2233972581049838e-08, -5.866046754246512e-11}, {0.2155748370052129, -0.021550691486037762, 0.0008740444004801464, -1.734536065053377e-05, 1.7056451791164763e-07, -6.64127555792364e-10}, {-0.1409544525093049, 0.009777067081033819, -0.00024045310921412484, 2.6984170127901197e-06, -1.1300656900401157e-08}, {0.48910964496393766, -0.04262851076166646, 0.0014966743107130555, -2.5980764728726465e-05, 2.2446233487664107e-07, -7.718280986123566e-10}, {0.48910964496393766, -0.04262851076166646, 0.0014966743107130555, -2.5980764728726465e-05, 2.2446233487664107e-07, -7.718280986123566e-10}, {36.924639555666225, -2.731053379993199, 0.08075735976399143, -0.0011930404315382429, 8.806330447805929e-06, -2.5983003498764035e-08}, {-2.04685752873405, 0.11986743294772255, -0.002619045423859335, 2.547582169584572e-05, -9.284824347257151e-08}, {7.911692446126537, -0.586430700151537, 0.017381404873950033, -0.0002571588951093972, 1.9001445552688971e-06, -5.60953061778946e-09}, {-0.04035976760548217, 0.0028960855784068945, -6.446518282673262e-05, 7.039405952083835e-07, -2.850405263641535e-09}, {0.00038939920185966734, 0.0001285557190217881, 8.69413028607202e-06, -2.573048095256053e-07, 3.792942498448278e-09, -2.0678344483899625e-11}, {114.1794092436988, -7.844377610524642, 0.2154622041453893, -0.0029572740228131214, 2.028318787128001e-05, -5.56153209596566e-08}, {63.85476055279725, -4.373918723108504, 0.11978407687501172, -0.001639115260273288, 1.1208079135748483e-05, -3.0637481399087285e-08}, {2.2011606537884574, -0.15929979266064095, 0.004617035140462986, -6.665696454532745e-05, 4.802401429301203e-07, -1.381218279507268e-09}, {0.14054974283190796, -0.013731761674997414, 0.0005489167427067969, -1.0602453960642565e-05, 1.0081527450614124e-07, -3.7623199206689856e-10}, {0.1375027208638757, -0.011426384406401128, 0.0003936373932723394, -6.566621326826848e-06, 5.436564330574909e-08, -1.784488488508658e-10}, {-2.0587964587833394, 0.11011667657698701, -0.002195246969371195, 1.9474914228398806e-05, -6.468524803770678e-08}, {-3.738753014306557e-05, 0.00019651018063277065, 5.029686927155719e-06, -1.860436206895368e-07, 3.619513097029327e-09, -2.3419351860382248e-11}, {-4.6986903194752225e-06, 0.00020166510590693542, 3.5139529776910723e-06, -8.35029903716272e-08, 1.0704336252071991e-09, -5.194413245346828e-12}, {-0.0001013315008795302, 0.00021751200379404063, 2.5505254420883194e-06, -5.644595705392902e-08, 7.208367517242021e-10, -3.529536880812241e-12}, {14.032584437026436, -0.8945191627957501, 0.022793327354797346, -0.00028994192427234664, 1.8417961141283543e-06, -4.673927900961106e-09}, {277.2985787430857, -16.743998506005166, 0.4042380831710037, -0.0048772009747539025, 2.9408099941209253e-05, -7.089501413704014e-08}, {238.59174345085714, -14.216481903802281, 0.33875311215278747, -0.004034711402427586, 2.4020773747460665e-05, -5.7186652135943206e-08}, {-0.014270322455909592, 0.001271856102731811, -2.6825640588792635e-05, 3.1709539327562703e-07, -1.348006901557479e-09}, {-0.003197806853972869, 0.0005120940287100591, -8.000797149141932e-06, 1.1825711728446569e-07, -5.879628780747985e-10}, {69.80528691032372, -4.185604044170307, 0.1003140574838752, -0.0012009323370808806, 7.1821054147923466e-06, -1.7164943383329856e-08}, {11.33988031617169, -0.7151239835112831, 0.01801498146412752, -0.00022633598572840852, 1.4186701820744602e-06, -3.5485919445965575e-09}, {291.70872987633373, -16.428266225780384, 0.36992638591060556, -0.004163027530618051, 2.3414353778369694e-05, -5.2653144622105685e-08}, {0.5385868914575095, -0.039063241767558904, 0.001139704473720059, -1.637798129261896e-05, 1.1672268143462329e-07, -3.2969635420203314e-10}, {-4.115988880205051, 0.19242977079412263, -0.003359010746960452, 2.60555082476192e-05, -7.564975914491415e-08}, {0.7253279314095107, -0.04554447213806413, 0.0011519312011070745, -1.4413835165122742e-05, 8.98047551542328e-08, -2.228159265166979e-10}, {490.2739379061497, -26.37733962281495, 0.567449605514974, -0.0061013236767764635, 3.278883438600014e-05, -7.045674199623875e-08}, {215.07848395075612, -11.537210273640513, 0.24746381290288713, -0.0026528264399308366, 1.4213575838962784e-05, -3.0449805399346275e-08}};

double approx(double dt, unsigned int id) {

    std::vector<double> coeffs = Coeffs[id];

    double ref = noise[id];
    double fit = 0;

    for (size_t i = 0; i < coeffs.size(); i++) {

        fit += coeffs[i] * std::pow(dt, i);

    }

    return fit/ref;

}

double approx_linear(double dt, unsigned int id) {

    std::vector<double> coeffs = Coeffs[id];

    double Ddt = dt - dts[id];

    double ref = noise[id];
    double fit = 0;

    if (id < noise.size()) { fit = noise[id] + (noise[id]-noise[id+1])*Ddt/(dts[id]-dts[id+1]);}
    else {fit = noise[id] + (noise[id]-noise[id-1])*Ddt/(dts[id]-dts[id-1]);}

    return fit/ref;

}

}
